<!DOCTYPE html>
<html lang="zh-Hant-TW" xmlns:th="http://www.thymeleaf.org/">

<head>
    <meta charset="UTF-8">
    <title>商品管理 - TickitEasy 管理系統</title>

    <!-- 引入 DataTables 的 CSS 和 JS 檔案 -->
    <link href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>

    <script>
        $(document).ready(function () {
            $('#productTable').DataTable({
                "language": {
                    "url": "${pageContext.request.contextPath}/resource/Chinese-traditional.json"
                },
                "pageLength": 10,
                "responsive": true,
                "ordering": true, // 确保排序功能开启
                "searching": true  // 确保搜索功能开启
            }); // 这里关闭 DataTable 的配置对象
        }); // 这里关闭 ready 函数
    </script>

</head>

<body>
    <div th:replace="~{commons/adminHeader}"></div>

    <!--  這裡是網頁內容 >-->
    <h1>商品管理</h1>
    <form method="get" action="${pageContext.request.contextPath}/AddProduct/showForm">
        <input type="submit" value="新增商品" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
    </form>

    <table id="productTable" class="display">
        <thead>
            <tr>
                <th>商品編號</th>
                <th>分類</th>
                <th>標籤</th>
                <th>商品名稱</th>
                <th>商品圖片</th>
                <th>商品描述</th>
                <th>價格</th>
                <th>庫存</th>
                <th>狀態</th>
                <th>評論總數</th>
                <th>總評分</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="prod : ${product}">
                <td th:text="${prod.productID}"></td>
                <td th:text="${prod.productCategory != null} ? ${prod.productCategory.categoryName} : '無'"></td>
                <td th:text="${prod.productTag != null} ? ${prod.productTag.tagName} : '無'"></td>
                <td th:text="${prod.productName}"></td>
                <td><img th:src="@{/images/product/{productPic}(productPic=${prod.productPic})}" alt="商品圖片" width="100"
                        height="100"></td>
                <td th:text="${prod.productDesc}"></td>
                <td th:text="${prod.price}"></td>
                <td th:text="${prod.stock}"></td>
                <td th:text="${prod.status == 1} ? '上架' : '下架'"></td>
                <td th:text="${prod.prodTotalReviews}"></td>
                <td th:text="${prod.prodTotalScore}"></td>
                <td>
                    <!-- 新增 修改 刪除 按鈕 -->
                    <a href="editProduct.html?id=${prod.productID}" class="btn btn-primary">修改</a>
                    <form th:action="@{/deleteProductById}" method="post" style="display:inline;">
                        <input type="hidden" name="productID" th:value="${prod.productID}" />
                        <button type="submit" class="btn btn-danger" onclick="return confirm('確定要刪除嗎？')">刪除</button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>



    <div th:replace="~{commons/adminFooter}"></div>
</body>

</html>